<h1>UpdateDatabase</h1>

<p>This small application has two modes of running.</p>

<ol>
<li>Update mode</li>
<li>Upgrade mode</li>
</ol>

<h2>Update mode</h2>

<p>When a project-file (<code>.sqlproj</code>) is specified or the app is run from the same folder as a project-file, the following steps will be taken:</p>

<ol>
<li>Load project-file</li>
<li>Increment minor version of <code>DacVersion</code>-property.</li>
<li>Build the project
<ul>
<li>On fail: Reset old version</li>
</ul></li>
<li>Find the newest <code>.dacpac</code>-file</li>
<li>Copy it to the Snapshots-folder</li>
<li>Include it in the project-file.</li>
</ol>

<h3>Examples</h3>

<pre><code>    UpdateDatabase.exe
</code></pre>

<p>or</p>

<pre><code>    UpdateDatabase.exe "C:\Development\Project.Database\Project.Database.sqlproj"
</code></pre>

<h2>Upgrade mode</h2>

<p>When a publish-file with or without extension (<code>.publish.xml</code>) is specified, the following steps will be taken:</p>

<ol>
<li>Load project-file (<code>.sqlproj</code> from same folder as the publish-file)</li>
<li>Find the latest snapshot (by sorted filenames)</li>
<li>Look up the target database version and compare to <code>.dacpac</code>-file</li>
</ol>

<p>Then, depending on the version comparison, one of the following tasks will be executed:</p>

<ul>
<li>Create database if the target doesn't exist</li>
<li>Upgrade database if <code>.dacpac</code>-version is newer than existing</li>
<li>Do nothing if the version is the same</li>
</ul>

<h3>Example</h3>

<pre><code>    UpdateDatabase.exe "C:\Development\Project.Database\DevSqlDeploy"
</code></pre>
